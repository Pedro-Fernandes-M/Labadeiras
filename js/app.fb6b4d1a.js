(function(){var e={883:function(e,t,n){"use strict";var o=n(751),r=n(564),a=n(641),u=n(278),l={__name:"App",setup(e){const t=(0,u.Pj)();return t.dispatch("connectToWebSocket"),(e,t)=>{const n=(0,a.g2)("router-view");return(0,a.uX)(),(0,a.Wv)(n)}}};const s=l;var i=s,c=n.p+"img/Tanque do Povo (1).922690da.png";const p={class:"container"};function d(e,t){const n=(0,a.g2)("RouterLink");return(0,a.uX)(),(0,a.CE)(a.FK,null,[t[3]||(t[3]=(0,a.Lk)("div",{class:"container1"},[(0,a.Lk)("img",{class:"logo",src:c,alt:"Tanque do Pobo"})],-1)),(0,a.Lk)("div",p,[(0,a.bF)(n,{to:"/"},{default:(0,a.k6)((()=>t[0]||(t[0]=[(0,a.eW)("Diário")]))),_:1}),(0,a.bF)(n,{to:"/year",class:"item"},{default:(0,a.k6)((()=>t[1]||(t[1]=[(0,a.eW)(" Explorar ")]))),_:1}),(0,a.bF)(n,{to:"/previsions"},{default:(0,a.k6)((()=>t[2]||(t[2]=[(0,a.eW)("Futuro")]))),_:1})])],64)}var v=n(262);const g={},m=(0,v.A)(g,[["render",d],["__scopeId","data-v-0571d8b3"]]);var _=m,h={__name:"PrevisionView",setup(e){return(e,t)=>((0,a.uX)(),(0,a.CE)("div",null,[(0,a.bF)(_),t[0]||(t[0]=(0,a.Lk)("br",null,null,-1)),t[1]||(t[1]=(0,a.Lk)("div",null,"Future Update",-1))]))}};const f=h;var b=f,k={__name:"YearView",setup(e){return(e,t)=>((0,a.uX)(),(0,a.CE)("div",null,[(0,a.bF)(_),t[0]||(t[0]=(0,a.Lk)("br",null,null,-1)),t[1]||(t[1]=(0,a.Lk)("div",null,"Future Update",-1))]))}};const y=k;var E=y,W=n(33);const w={class:"flex"},S={class:"container"},L={class:"container"};var C={__name:"ActiveCount",setup(e){const t=(0,u.Pj)(),n=(0,a.EW)((()=>-1==t.getters.getCount?"--":t.getters.getCount));let o=0;const r=(0,a.EW)((()=>{const e=t.getters.getDaily;return null==e?-1:(e.forEach((e=>{o+=parseInt(e.count)})),(o/e.length).toFixed(2))})),l=new Date,s=["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],i=`${l.getDate()} de ${s[l.getMonth()]}`,c=(0,a.EW)((()=>{const e=t.getters.getDaily;if(null==e)return-1;const n=e.filter((e=>e.count>0)).length;return(n/e.length*100).toFixed(0)+"%"})),p=(0,a.EW)((()=>"green"===t.getters.getBg?(d(),"bg-green"):"red"===t.getters.getBg?(d(),"bg-red"):null));function d(){setTimeout((()=>{t.commit("setBg","bg")}),600)}return(e,t)=>((0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.Lk)("div",{class:"container1"},[(0,a.Lk)("h2",null,(0,W.v_)(i))]),(0,a.Lk)("div",w,[(0,a.Lk)("div",{class:(0,W.C4)(["container",[p.value]])},[(0,a.Lk)("h3",null,[(0,a.eW)((0,W.v_)(n.value)+" ",1),t[0]||(t[0]=(0,a.Lk)("br",null,null,-1)),t[1]||(t[1]=(0,a.eW)(" Ativos "))]),t[2]||(t[2]=(0,a.Lk)("div",{class:"line"},null,-1))],2),(0,a.Lk)("div",S,[(0,a.Lk)("h3",null,[(0,a.eW)((0,W.v_)(c.value)+" ",1),t[3]||(t[3]=(0,a.Lk)("br",null,null,-1)),t[4]||(t[4]=(0,a.eW)(" Ocupação "))]),t[5]||(t[5]=(0,a.Lk)("div",{class:"line"},null,-1))]),(0,a.Lk)("div",L,[(0,a.Lk)("h3",null,[(0,a.eW)((0,W.v_)(r.value)+" ",1),t[6]||(t[6]=(0,a.Lk)("br",null,null,-1)),t[7]||(t[7]=(0,a.eW)(" Média "))]),t[8]||(t[8]=(0,a.Lk)("div",{class:"line"},null,-1))])])],64))}};const x=(0,v.A)(C,[["__scopeId","data-v-3f7e4037"]]);var P=x,A=n(953);const O={class:"warning"};var F={__name:"WarningPop",props:["nome"],setup(e){const t=e;return(e,n)=>((0,a.uX)(),(0,a.CE)("div",null,[(0,a.Lk)("div",O,(0,W.v_)(t.nome)+" indisponível! ",1)]))}};const j=(0,v.A)(F,[["__scopeId","data-v-76efdd9e"]]);var T=j;const V={key:0,class:"container"};var D={__name:"CountChart",setup(e){const t=(0,u.Pj)(),n=(0,a.EW)((()=>t.getters.getDaily)),o=(0,a.EW)((()=>{const e=[];return n.value.forEach((t=>{e.push(t.hour)})),e})),r=(0,a.EW)((()=>{const e=[];return n.value.forEach((t=>{console.log(t.count),e.push(t.count)})),e})),l=(0,A.KR)({chart:{toolbar:{show:!1}},title:{text:"Contagem",align:"center",style:{fontSize:"18px",fontWeight:"bold"}},xaxis:{categories:o}}),s=(0,A.KR)([{name:"count",data:r}]);return(e,t)=>{const o=(0,a.g2)("apexchart");return null!=n.value&&n.value.length>1?((0,a.uX)(),(0,a.CE)("div",V,[(0,a.bF)(o,{width:"100%",height:"200%",type:"bar",options:l.value,series:s.value},null,8,["options","series"])])):((0,a.uX)(),(0,a.Wv)(T,{key:1,nome:"Contagem"}))}}};const U=(0,v.A)(D,[["__scopeId","data-v-fe516ee2"]]);var R=U;const $={key:0};var M={__name:"MultiChart",setup(e){const t=(0,u.Pj)(),n=(0,a.EW)((()=>t.getters.getWeather)),r=(0,A.KR)("Temperatura"),l=(0,a.EW)((()=>{const e=n.value.daily.time,t=Object.values(e),o=[];return t.forEach((e=>{const[,t,n]=e.split("-");o.push(`${n}-${t}`)})),o})),s=(0,A.KR)({chart:{toolbar:{show:!1},zoom:{enabled:!1}},title:{text:`${r.value}`,align:"center",style:{fontSize:"18px",fontWeight:"bold"}},xaxis:{categories:l}}),i=(0,a.EW)((()=>{if("Temperatura"===r.value){const e=n.value.daily.temperature_2m_max;return Object.values(e)}if("Precipitação"===r.value){const e=n.value.daily.precipitation_hours;return Object.values(e)}if("Chuva/Vento"===r.value){const e=n.value.daily.rain_sum;return Object.values(e)}if("Evaporação"===r.value){const e=n.value.daily.et0_fao_evapotranspiration;return Object.values(e)}return null})),c=(0,a.EW)((()=>{if("Temperatura"===r.value){const e=n.value.daily.temperature_2m_min;return Object.values(e)}if("Precipitação"===r.value){const e=n.value.daily.precipitation_probability_max;return Object.values(e)}if("Chuva/Vento"===r.value){const e=n.value.daily.wind_speed_10m_max;return Object.values(e)}return[]})),p=(0,a.EW)((()=>"Temperatura"===r.value?(v(),"Temperatura_Max(°C)"):"Precipitação"===r.value?(v(),"Precipitação_Horas"):"Chuva/Vento"===r.value?(v(),"Chuva_Sum(mm)"):"Evaporação"===r.value?(v(),"Evapotranspiração(mm)"):null)),d=(0,a.EW)((()=>"Temperatura"===r.value?"Temperatura_Min(°C)":"Precipitação"===r.value?"Precipitação_Prob_Máx(%)":"Chuva/Vento"===r.value?"Velocidade_Vento_Max(KM/H)":""));function v(){"Temperatura"===r.value||"Precipitação"===r.value||"Chuva/Vento"===r.value?g.value=[{name:p,data:i},{name:d,data:c}]:g.value=[{name:p,data:i}]}const g=(0,A.KR)([{name:p,data:i},{name:d,data:c}]);return(e,t)=>{const u=(0,a.g2)("apexchart");return(0,a.uX)(),(0,a.CE)("div",null,[null!=n.value&&null!=g.value?((0,a.uX)(),(0,a.CE)("div",$,[(0,a.bF)(u,{width:"100%",height:"200%",type:"line",options:s.value,series:g.value},null,8,["options","series"])])):((0,a.uX)(),(0,a.Wv)(T,{key:1,nome:r.value},null,8,["nome"])),(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>r.value=e),class:"options"},t[1]||(t[1]=[(0,a.Lk)("option",null,"Temperatura",-1),(0,a.Lk)("option",null,"Precipitação",-1),(0,a.Lk)("option",null,"Chuva/Vento",-1),(0,a.Lk)("option",null,"Evaporação",-1)]),512),[[o.u1,r.value]])])}}};const X=(0,v.A)(M,[["__scopeId","data-v-3f487221"]]);var B=X;const I={key:0,class:"flex"},N={class:"container"},K={class:"container"};var z={__name:"StatesSpec",setup(e){const t=(0,u.Pj)(),n=(0,a.EW)((()=>t.getters.getWeather.current.apparent_temperature)),o=(0,a.EW)((()=>t.getters.getWeather.current.relative_humidity_2m));return(e,r)=>((0,a.uX)(),(0,a.CE)("div",null,[null!=(0,A.R1)(t).getters.getWeather?((0,a.uX)(),(0,a.CE)("div",I,[(0,a.Lk)("div",N,[(0,a.Lk)("h3",null,[(0,a.eW)((0,W.v_)(n.value)+"°C ",1),r[0]||(r[0]=(0,a.Lk)("br",null,null,-1)),r[1]||(r[1]=(0,a.eW)(" Temperatura "))]),r[2]||(r[2]=(0,a.Lk)("div",{class:"line"},null,-1))]),(0,a.Lk)("div",K,[(0,a.Lk)("h3",null,[(0,a.eW)((0,W.v_)(o.value)+"% ",1),r[3]||(r[3]=(0,a.Lk)("br",null,null,-1)),r[4]||(r[4]=(0,a.eW)(" Umidade "))]),r[5]||(r[5]=(0,a.Lk)("div",{class:"line"},null,-1))])])):(0,a.Q3)("",!0)]))}};const H=(0,v.A)(z,[["__scopeId","data-v-b2fbff86"]]);var J=H,q={__name:"DayView",setup(e){const t=(0,u.Pj)(),n=new Date,o=new Date(n);o.setDate(n.getDate()-5);const r=n.toISOString().split("T")[0],l=o.toISOString().split("T")[0],[,s,i]=r.split("-");return t.dispatch("fetch",`daily?day=${i}&month=${s}`),t.dispatch("weather",[`${l}`,`${r}`]),(e,t)=>((0,a.uX)(),(0,a.CE)("div",null,[(0,a.bF)(_),(0,a.bF)(P),(0,a.bF)(J),(0,a.bF)(R),(0,a.bF)(B)]))}};const Y=(0,v.A)(q,[["__scopeId","data-v-4e3bdcfd"]]);var Q=Y,G=n(220);const Z=[{path:"/",name:"day",component:Q},{path:"/year",name:"year",component:E},{path:"/previsions",name:"previsions",component:b}],ee=(0,G.aE)({history:(0,G.LA)("/undefined/"),routes:Z});var te=ee,ne=n(396),oe=n.n(ne),re=(0,u.y$)({state:{count:-1,socket:null,yearly:null,daily:null,weather:null,bg:null},getters:{getCount(e){return e.count},getYearly(e){return e.yearly},getDaily(e){return e.daily},getWeather(e){return e.weather},getBg(e){return e.bg}},mutations:{setCount(e,t){e.count=t},setSocket(e,t){e.socket=t},setyearly(e,t){e.yearly=t},setdaily(e,t){e.daily=t},setWeather(e,t){e.weather=t},setBg(e,t){e.bg=t}},actions:{async fetchWebSocketURL(){try{const e=await fetch({NODE_ENV:"production",BASE_URL:"/undefined/"}.VUE_APP_API_URL+"websocket-url?token=2024",{headers:{"ngrok-skip-browser-warning":"true"}});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return await e.text()}catch(e){console.error("Error fetching WebSocket URL:",e)}},async connectToWebSocket({commit:e,state:t,dispatch:n}){const o=await n("fetchWebSocketURL");if(console.log(o),!o)throw new Error("WebSocket URL is undefined or empty");if(t.socket)console.log("WebSocket já está conectado.");else try{const n=new WebSocket(o);n.onopen=()=>{console.log("Conexão WebSocket estabelecida!")},n.onmessage=n=>{try{const o=JSON.parse(n.data);void 0!==o.person_count?(console.log("Atualização de person_count recebida:",o.person_count),t.count<o.person_count?e("setBg","green"):e("setBg","red"),e("setCount",o.person_count)):console.warn("Mensagem WebSocket recebida não contém person_count:",o)}catch(o){console.error("Erro ao processar mensagem WebSocket:",o)}},n.onclose=()=>{console.log("Conexão WebSocket encerrada."),e("setSocket",null)},n.onerror=e=>{console.error("Erro no WebSocket:",e)},e("setSocket",n)}catch(r){console.error("Erro ao conectar ao WebSocket:",r)}},disconnectWebSocket({commit:e,state:t}){t.socket?(t.socket.close(),e("setSocket",null),console.log("Conexão WebSocket encerrada manualmente.")):console.log("Nenhuma conexão WebSocket ativa para encerrar.")},async fetch({commit:e},t){const n=new Date,o=n.getFullYear().toString()+(n.getMonth()+1).toString().padStart(2,"0")+n.getDate().toString().padStart(2,"0"),r={NODE_ENV:"production",BASE_URL:"/undefined/"}.VUE_APP_PASS+o;console.log("crypt pass:",{NODE_ENV:"production",BASE_URL:"/undefined/"}.VUE_APP_PASS);try{const n=await fetch({NODE_ENV:"production",BASE_URL:"/undefined/"}.VUE_APP_API_URL+t,{headers:{"ngrok-skip-browser-warning":"true"}}),o=await n.json(),a=new Promise(((e,t)=>{(async()=>{try{if(!r||!o||!o.data)return t(console.error("Missing required fields in the data."));const[a,u]=o.data.split(":");if(!a||!u)return t(new Error("Invalid base64 string format"));let l,s;try{l=oe().enc.Base64.parse(a),s=oe().enc.Base64.parse(u)}catch(n){return t(new Error("Failed to decode base64: "+n.message))}const i=oe().SHA256(r).toString(oe().enc.Hex),c=oe().AES.decrypt({ciphertext:s},oe().enc.Hex.parse(i),{iv:l}),p=JSON.parse(c.toString(oe().enc.Utf8));e(p)}catch(a){t(a)}})()}));a.then((n=>{let o=t.replace("?",",").split(",");e(`set${o[0]}`,n),console.log(`${o[0]}:`,n)}))}catch(a){console.error("Error fetching data:",a)}},async weather({commit:e},t){console.log(t[0],t[1]);const n=await fetch(`https://api.open-meteo.com/v1/forecast?latitude=41.625&longitude=-8.4375&elevation=35.4&current=relative_humidity_2m,apparent_temperature&daily=temperature_2m_max,temperature_2m_min,precipitation_sum,rain_sum,showers_sum,wind_speed_10m_max,precipitation_hours,precipitation_probability_max,sunrise,sunset,et0_fao_evapotranspiration&timezone=Europe%2FLondon&start_date=${t[0]}&end_date=${t[1]}`),o=await n.json();e("setWeather",o),console.log("Weather:",o)}},modules:{}});(0,o.Ef)(i).use(re).use(te).use(r.A).mount("#app")},477:function(){}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var a=t[o]={exports:{}};return e[o].call(a.exports,a,a.exports,n),a.exports}n.m=e,function(){var e=[];n.O=function(t,o,r,a){if(!o){var u=1/0;for(c=0;c<e.length;c++){o=e[c][0],r=e[c][1],a=e[c][2];for(var l=!0,s=0;s<o.length;s++)(!1&a||u>=a)&&Object.keys(n.O).every((function(e){return n.O[e](o[s])}))?o.splice(s--,1):(l=!1,a<u&&(u=a));if(l){e.splice(c--,1);var i=r();void 0!==i&&(t=i)}}return t}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[o,r,a]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.p="/undefined/"}(),function(){var e={524:0};n.O.j=function(t){return 0===e[t]};var t=function(t,o){var r,a,u=o[0],l=o[1],s=o[2],i=0;if(u.some((function(t){return 0!==e[t]}))){for(r in l)n.o(l,r)&&(n.m[r]=l[r]);if(s)var c=s(n)}for(t&&t(o);i<u.length;i++)a=u[i],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return n.O(c)},o=self["webpackChunkdetection"]=self["webpackChunkdetection"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=n.O(void 0,[504],(function(){return n(883)}));o=n.O(o)})();
//# sourceMappingURL=app.fb6b4d1a.js.map